---
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import DemoCard from "../../components/DemoCard.astro";
import Shell from "../../layouts/Shell.astro";
import Footer from "../../components/Footer.astro";
import BlogDoodle from "./blog-doodle.png";
import { productFromUrl } from "../../lib/products";
import ProductNav from "../../components/nav/product/Nav.astro";

const product = productFromUrl(Astro.url);

const [demo1, demo2, ...restDemos] = await getCollection(
	"showcase",
	({ data }) =>
		data.draft !== true && (!product || data?.tags?.includes(product.name))
);
---

<Shell
	title="Demo showcase"
	description={`Discover projects built with ${product?.name}`}
>
	{product && <ProductNav {product} />}
	<header class="text-center text-stone-100 py-16">
		<div class="flex justify-center items-center">
			<Image
				src={BlogDoodle}
				width="150"
				height="129"
				class="invisible md:visible"
				alt="person reading a newspaper"
			/>
		</div>

		<h1 class="text-5xl font-semibold text-balance">Demo showcase</h1>
		<p class="text-lg text-balance my-8 text-stone-400">
			{
				`Discover amazing projects built with ${product?.name} by our community, ourselves and collaborators`
			}
		</p>
		<div
			class="bg-gradient-to-b from-primary-600 to-transparent opacity-20 w-full h-[40rem] absolute inset-0 -z-10"
		>
			<!-- cool background -->
		</div>
	</header>

	<section class="pb-24 px-6 mx-auto w-full max-w-screen-xl">
		<ul class="grid md:grid-cols-2 gap-8 mb-8">
			{
				[demo1, demo2].map((demo) => (
					<li class="flex md:justify-stretch md:items-stretch">
						{demo && <DemoCard {demo} showMetadata size="wide" />}
					</li>
				))
			}
		</ul>
		<ul class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
			{
				restDemos.map((demo) => (
					<li class="flex md:justify-stretch md:items-stretch">
						<DemoCard {demo} showMetadata />
					</li>
				))
			}
		</ul>
	</section>

	<Footer />
</Shell>
